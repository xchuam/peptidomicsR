---
title: "peptidomicsR"
output: github_document
---

# peptidomicsR

**Tools for peptidomics analysis of digesta from protein digestion**

`peptidomicsR` provides functions to process, filter, analyze, and visualize peptidomics data, especially from MaxQuant protein digestion studies. This README introduces the package through three parts:

âœ¨ **Functions**

ðŸš€ **Example analysis workflow**

ðŸ“Š **Example plots**

------------------------------------------------------------------------

## âœ¨ Functions

### Data processing --- `processPeptides()`

-   Import MaxQuant *peptides* file, intensity-column metadata, and protein mapping.
-   Automatically remove contaminants and reverse sequences.
-   Compute replicate- and group-level mean intensities and peptide counts.
-   Map parent protein name and protein group for each peptide.
-   Calculate peptide GRAVY scores.

### Filtering & statistics

-   **PCA** analysis to pre-check group separation --- `pcaPeptides()`.
-   Subset by sequence, regex pattern, or grouping variables --- `filterPeptides()`.
-   Compare specific groups with t-tests or **limma::treat** to obtain significantly different peptides --- `ttestPeptides()`.

### Visualization

-   Stacked bar plots of **peptide intensities** by parent proteins --- `plot_int()`.
-   Stacked bar plots of **peptide counts** by parent proteins --- `plot_count()`.
-   **Peptide-length distribution** (by intensity or counts) --- `plot_length_distribution()`.
-   **Cleavage-site** intensity (N/C/both termini) --- `plot_cleavage_site()`.
-   **GRAVY vs. intensity** scatter --- `plot_gravy_vs_intensity()`.
-   **PCA** plot to quickly assess group separation --- `plot_pcaPeptides()`.
-   **Volcano plot(s)** for differential tests (t.test or limma) --- `plot_volcano()`.

------------------------------------------------------------------------

## ðŸš€ Example analysis workflow

1.  Import and process data â†’ `processPeptides()`
2.  Explore distributions:
    -   Intensities â†’ `plot_int()`
    -   Counts â†’ `plot_count()`
    -   Length distribution â†’ `plot_length_distribution()`
    -   Cleavage sites â†’ `plot_cleavage_site()`
    -   Hydrophobicity trends â†’ `plot_gravy_vs_intensity()`
3.  Filter subsets of peptides â†’ `filterPeptides()`
4.  Perform statistical comparisons â†’ `ttestPeptides()`
5.  Visualize results â†’ `plot_volcano()`

------------------------------------------------------------------------

## ðŸ“¦ Installation

```{r}
# Install from GitHub
if (!require("devtools")) install.packages("devtools")
devtools::install_github("xchuam/peptidomicsR")

if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager")
BiocManager::install("limma")
```

------------------------------------------------------------------------

## ðŸ“Š Example plots

> This is only a small sample of the functions included in the package!\
> For a complete list, please check the package vignette.

### 1) Import and process data

```{r}
library(peptidomicsR)

result <- processPeptides(
  peptides_file          = "Data/peptides.txt",
  intensity_columns_file = "Data/Intensity_columns.csv",
  protein_mapping_file   = "Data/protein_mapping.csv"
)
```

### 2) Mean peptide intensities by parent proteins

```{r pressure, echo=FALSE}
plot_int(
  result,
  x_var         = "Lipid",
  type          = "mean",
  facet_cols    = "Casein.ratio",
  filter_params = list(Digest.stage = "I"),
  color_by      = "Protein.name"
)
```

### 3) Peptide-length distribution (by intensity)

```{r}
plot_length_distribution(
  result,
  facet_cols    = "Casein.ratio",
  facet_rows    = "Lipid",
  filter_params = list(Digest.stage = "I")
)
```

### 4) Cleavage-site intensity (N and/or C termini)

```{r}
plot_cleavage_site(
  result,
  terminal              = "both",       # "N", "C", or "both"
  measure               = "intensity",  # "intensity" or "count"
  replicate_mode        = "mean",       # "mean" or "reps"
  filter_params         = list(Digest.stage = "I"),
  scientific_10_y       = TRUE,
  drop_constant_groups  = TRUE
)
```

### 5) GRAVY vs. log10 intensity

```{r}
plot_gravy_vs_intensity(
  result,
  facet_cols    = "Casein.ratio",
  facet_rows    = "Lipid",
  filter_params = list(Digest.stage = "G")
)
```

### 6) Differential testing (t-test or limma::treat)

```{r}
comparisons <- list(c("C40_G_N", "C40_I_N"))

ttest_result <- ttestPeptides(
  result,
  comparisons       = comparisons,
  pseudocount       = 1,
  test_method       = "treat",  # "treat" or "plain"
  lfc_thresh        = 1,
  alpha             = 0.05,
  equal_var         = FALSE,
  adjust            = "BH",
  min_reps_per_side = 2
)
```

### 7) Volcano plot(s)

```{r}
plot_volcano(
  ttest_result    = ttest_result,
  comparisons     = comparisons,
  test_method     = "treat",
  show_threshold  = TRUE,
  lfc_thresh      = 1,
  alpha           = 0.05,
  fill_values     = c(no = "grey75", yes = "#FFC010"),
  point_size      = 2,
  point_alpha     = 0.85,
  label_seqs      = NULL,
  label_size      = 3,
  label_col       = "black",
  highlight_seqs  = NULL,
  highlight_size  = NULL,
  y_log_scale     = FALSE
)
```

------------------------------------------------------------------------

## ðŸ› ï¸ Dependencies

-   `data.table`, `ggplot2`, `ggpubr`, `scales` (plots & helpers)
-   `limma` (optional; for `treat`)

------------------------------------------------------------------------

## ðŸ“– Citation

If you use **peptidomicsR** in your work, please cite this repository.

------------------------------------------------------------------------

## ðŸ“œ License

This project is licensed under the **MIT License** -- see the `LICENSE` file for details.

```{r setup, include=FALSE}

knitr::opts_chunk$set(
  fig.path   = "man/figures/",
  fig.width  = 8,
  fig.height = 5,
  dpi        = 150,
  echo       = TRUE,
  message    = FALSE,
  warning    = FALSE
)

```

```{r}
# Install from GitHub
if (!require("devtools")) install.packages("devtools")
devtools::install_github("xchuam/peptidomicsR")

library(peptidomicsR)
result <- processPeptides(
  peptides_file          = "Data/peptides.txt",
  intensity_columns_file = "Data/Intensity_columns.csv",
  protein_mapping_file   = "Data/protein_mapping.csv"
)

```

```{r}
plot_int(
  result,
  x_var         = "Lipid",
  type          = "mean",
  facet_cols    = "Casein.ratio",
  filter_params = list(Digest.stage = "I"),
  color_by      = "Protein.name"
)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
