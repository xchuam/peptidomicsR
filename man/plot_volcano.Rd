% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_volcano.R
\name{plot_volcano}
\alias{plot_volcano}
\title{Volcano plot(s) for peptide differential tests (t.test or limma TREAT)}
\usage{
plot_volcano(
  ttest_result,
  comparisons,
  test_method = c("treat", "plain"),
  show_threshold = TRUE,
  lfc_thresh = 1,
  alpha = 0.05,
  fill_values = c(no = "grey75", yes = "#FFC010"),
  point_size = 2,
  point_alpha = 0.85,
  label_seqs = NULL,
  label_size = 3,
  label_col = "black",
  highlight_seqs = NULL,
  highlight_size = NULL,
  highlight_stroke = 1.2,
  y_log_scale = FALSE
)
}
\arguments{
\item{ttest_result}{A named list of \code{data.table}s as returned by \code{ttestPeptides()},
where each element is one comparison result table containing at least
\code{Sequence}, \code{log2FC}, \code{p.adj}, and \code{sig}.}

\item{comparisons}{Comparison selector. Either:
\enumerate{
\item index mode: an integer, numeric vector, or list of integers indexing \code{ttest_result}, or
\item name-pair mode: a character vector of length 2 (e.g., \code{c("A","B")}) or a list of such vectors,
which will be resolved to names like \code{"A_vs_B"} in \code{ttest_result}.
}}

\item{test_method}{Character; either \code{"treat"} (default) or \code{"plain"}.
Controls which threshold lines are drawn, matching how the test was performed.
This should match how the tests were performed in \code{ttestPeptides()}.}

\item{show_threshold}{Logical; draw threshold lines. Default \code{TRUE}.}

\item{lfc_thresh}{Numeric; absolute log2 fold-change threshold for the \code{"plain"} method
(ignored for drawing when \code{test_method = "treat"}).
This should match how the tests were performed in \code{ttestPeptides()}.
Default \code{1}.}

\item{alpha}{Numeric in (0,1]; adjusted p-value cutoff for threshold line.
This should match how the tests were performed in \code{ttestPeptides()}.
Default \code{0.05}.}

\item{fill_values}{Named character vector of length 2 giving colors for significant and not sinificant points.
\code{c(no = "...", yes = "...")}, used by \code{scale_fill_manual()} and \code{scale_color_manual()}.
Default \code{c(no = "grey75", yes = "#FFC010")}.}

\item{point_size}{Numeric; point size for the base layer. Default \code{2}.}

\item{point_alpha}{Numeric in \link{0,1}; base point transparency. Default \code{0.85}.}

\item{label_seqs}{Character vector of peptide sequences to label by text (non-overlapping) and rings. Default \code{NULL}.}

\item{label_size}{Numeric; text size for labels. Default \code{3}.}

\item{label_col}{Character; label text and marker border color. Default \code{"black"}.}

\item{highlight_seqs}{Named list where each name is a border color and each element is a character
vector of sequences to highlight by rings. Default \code{NULL}.}

\item{highlight_size}{Numeric; size of the highlight rings (defaults to \code{point_size + 0.6} if \code{NULL}).}

\item{highlight_stroke}{Numeric; thickness of the highlight rings. Default \code{1.2}.}

\item{y_log_scale}{Logical; if \code{TRUE}, use a log10 axis on \eqn{-log10(p.adj)} with tick labels
shown in the original \eqn{-log10(p.adj)} scale. Default \code{FALSE}.}
}
\value{
A \emph{named list} of \code{ggplot} objects, one per requested comparison.
Names are the same as selected \code{ttest_result} element names.
}
\description{
Create one or multiple volcano plots from a \code{ttestPeptides()} result list.
Each plot shows \code{log2FC} on the x-axis and \eqn{-log10(adjusted~p)} on the y-axis,
optionally with a log-scaled y-axis. Points are colored
by significance using the \code{sig} column produced by \code{ttestPeptides()}.
Threshold lines are drawn depending on \code{test_method}:
\itemize{
\item \code{"treat"}: a horizontal line at \eqn{-log10(\alpha)} (log2 fold-change threshold is baked into TREAT).
\item \code{"plain"}: horizontal line at \eqn{-log10(\alpha)} plus vertical lines at
\eqn{\pm} \code{lfc_thresh}.
}
}
\details{
\strong{Selecting comparisons.} \code{comparisons} supports two modes:
\enumerate{
\item \emph{Index mode}: a single integer, numeric vector, or list of integers.
e.g., \code{1}, \code{c(1,3)}, or \code{list(2,4)}.
These index into \code{ttest_result}. The output list keeps the corresponding names
from \code{ttest_result} for those indices.
\item \emph{Name-pair mode}: a character vector of length 2 (e.g., \code{c("A","B")}) or a list of such vectors.
For each pair \code{c("A","B")}, the function looks up the element named \code{"A_vs_B"} in \code{ttest_result}.
}

\strong{Labels and highlights.} The function support to label and highlight the points of selected sequences.
\itemize{
\item \code{label_seqs}: sequences to annotate with non-overlapping text.
\item \code{highlight_seqs}: a \emph{named list} mapping border color \eqn{\rightarrow} character vector of sequences.
Each color creates a ring around the selected points.
e.g., \code{list("red" = c(Seq1, Seq2), "blue" = c(Seq3, Seq4))}
}
}
\examples{
\dontrun{
# Prepare data
result <- processPeptides(
  peptides_file          = "../Data/peptides.txt",
  intensity_columns_file = "../Data/Intensity_columns.csv",
  protein_mapping_file   = "../Data/protein_mapping.csv"
)
# suppose you ran ttestPeptides() like this with default test_method = "treat",
  lfc_thresh = 1 and alpha = 0.05:
ttest.1 <- ttestPeptides(
  result,
  comparisons = list(
    c("C40_G_N", "C40_I_N"),
    c("C40_G_N", "C80_I_N")
  )
)

# 1) Plot by indices (index mode)
v1 <- plot_volcano(
  ttest_result = ttest.1,
  comparisons  = c(1, 2),                 # or list(1L, 2L)
)
v1$C40_G_N_vs_C80_I_N   # show one

# 2) Plot by name pairs and try different colors
v2 <- plot_volcano(
 ttest_result = ttest.1,
 comparisons = list(
   c("C40_G_N", "C40_I_N"),
   c("C40_G_N", "C80_I_N")
 ),
 fill_values  = c(no = "grey80", yes = "#E41A1C")
)
v2$C40_G_N_vs_C40_I_N

# 3) Label a few sequences and enable y-axis log scaling
some_peps <- c("AAEVIREA", "AAEVIREALQGITDPLFK")
v3 <- plot_volcano(
  ttest_result = ttest.1,
  comparisons  = 1,
  label_seqs   = some_peps,
  label_col    = "black",
  y_log_scale  = TRUE
)
v3$C40_G_N_vs_C40_I_N

# 4) Highlight selected peptides with colored rings, set highlight size = 2 and stroke = 2
hl <- list(black = c("AAEVIREA"),
           "#377EB8" = c("AAEVIREALQGITDPLFK"))
v4 <- plot_volcano(
ttest_result   = ttest.1,
  comparisons    = 1,
  test_method    = "plain",
  highlight_seqs = hl,
  highlight_size = 2,
  highlight_stroke = 2
)
v4$C40_G_N_vs_C40_I_N
}

# 5) suppose you ran ttestPeptides() not with the default settings:
my_lfc_thresh <- 2
my_alpha = 0.05
ttest.2 <- ttestPeptides(
  result,
  comparisons = list(
    c("C40_G_N", "C40_I_N"),
    c("C40_G_N", "C80_I_N")
  ),
  test_method  = "plain",
  lfc_thresh = my_lfc_thresh,
  alpha      = my_alpha
)
v5 <- plot_volcano(
  ttest_result   = ttest.2,
  comparisons    = c(1,2),
  test_method    = "plain",
  lfc_thresh     = my_lfc_thresh,
  alpha          = my_alpha
)
v5$C40_G_N_vs_C40_I_N

}
\seealso{
\code{\link{ttestPeptides}}
}
