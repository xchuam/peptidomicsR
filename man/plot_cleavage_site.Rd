% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_cleavage_site.R
\name{plot_cleavage_site}
\alias{plot_cleavage_site}
\title{Plot N/C-terminal peptide cleavage site sequqnce logos by group}
\usage{
plot_cleavage_site(
  result,
  terminal = c("both", "N", "C"),
  measure = c("intensity", "count"),
  replicate_mode = c("mean", "reps"),
  filter_params = NULL,
  scientific_10_y = TRUE,
  drop_constant_groups = TRUE
)
}
\arguments{
\item{result}{List. Output of \code{processPeptides()}. Must contain:
\itemize{
\item \code{dt.peptides.int.reps}: data.table with per-replicate peptide intensities
(columns include grouping variables in \code{grp_cols}, \code{Replicate},
\code{Intensity}, \code{First.amino.acid}, \code{Last.amino.acid}).
\item \code{grp_cols}: character vector of grouping columns to define sample groups.
}}

\item{terminal}{Character. Which terminal(s) to plot: one of \code{"both"}, \code{"N"}, or \code{"C"}. Default \code{"both"}.}

\item{measure}{Character. What to aggregate: \code{"intensity"} (sum of intensities per replicate) or \code{"count"}
(number of peptides with non-zero intensity per replicate). Default \code{"intensity"}.}

\item{replicate_mode}{Character. How to handle replicates:
\code{"mean"} (average replicate values within each group) or
\code{"reps"} (treat each replicate as its own x-axis level).
Default: \code{"mean"}.}

\item{filter_params}{Named list, or \code{NULL}.  Each elementâ€™s name is a grouping column,
and its value is a vector of values to include.  Multiple names impose an AND filter.
For example: \code{list(Lipid = c("N","S"), Digest.stage = "G")}
Default: \code{NULL} (no filtering).}

\item{scientific_10_y}{Logical.  If \code{TRUE}, use scientific notation for y-axis.
Default: \code{TRUE}.}

\item{drop_constant_groups}{Logical. If \code{TRUE}, any grouping columns from
\code{result$grp_cols} (and \code{Replicate} when \code{replicate_mode = "reps"})
that have only one remaining level after filtering are dropped from the x-axis
grouping. Default: \code{TRUE}.}
}
\value{
A \code{ggplot} object when \code{terminal} is \code{"N"} or \code{"C"};
otherwise a combined grob (two panels) when \code{terminal = "both"}.
}
\description{
Visualize amino-acid preferences at peptide cleavage sites using sequence logos,
aggregated from the \code{processPeptides()} result. You can plot the N- or
C-terminal residue distribution (or both), measure either total intensity or
peptide counts, average replicates or show each replicate separately, and
optionally drop grouping columns that are constant after filtering so the
x-axis only reflects variables that truly vary.
}
\examples{
\dontrun{
# Prepare data
result <- processPeptides(
  peptides_file          = "../Data/peptides.txt",
  intensity_columns_file = "../Data/Intensity_columns.csv",
  protein_mapping_file   = "../Data/protein_mapping.csv"
)

# 1) N-terminal, mean over replicates, intensity
p1 <- plot_cleavage_site(
  result,
  terminal       = "N",
  measure        = "intensity",
  replicate_mode = "mean"
)

# 2) C-terminal, show each replicate separately on x (labels include Replicate)
p2 <- plot_cleavage_site(
  result,
  terminal       = "C",
  measure        = "count",
  replicate_mode = "reps"
)

# 3) Both terminals side by side; filter and drop constant grouping columns on x
p3 <- plot_cleavage_site(
  result,
  terminal            = "both",
  measure             = "intensity",
  replicate_mode      = "mean",
  filter_params       = list(Lipid = "N", Digest.stage = "G"),
  drop_constant_groups = TRUE
)

# 4) Keep all grouping columns on x even if constant; single x label when all collapse
p4 <- plot_cleavage_site(
  result,
  terminal              = "N",
  measure               = "intensity",
  replicate_mode        = "mean",
  filter_params         = list(Lipid = "N", Digest.stage = "G"),
  drop_constant_groups  = FALSE
)
}

}
