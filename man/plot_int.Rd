% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_int.R
\name{plot_int}
\alias{plot_int}
\title{Plot peptide intensities with optional scientific notation y-axis, flexible filtering and faceting}
\usage{
plot_int(
  result,
  type = c("mean", "reps"),
  x_var = NULL,
  color_by = "Protein.group",
  filter_params = NULL,
  facet_rows = NULL,
  facet_cols = NULL,
  scientific_10_y = TRUE
)
}
\arguments{
\item{result}{List. Output of \code{processPeptides()}, containing at least:
\itemize{
\item \code{dt.peptides.int.reps}: replicate intensities,
\item \code{dt.peptides.int}: mean intensities,
\item \code{grp_cols}: character vector of grouping column names.
}}

\item{type}{Character. Which table to plot: \code{"reps"} (replicate‐level) or \code{"mean"} (group‐mean). Default: \code{"mean"}.}

\item{x_var}{Character. Name of the grouping column to use on the x‐axis.
Must be one of \code{result$grp_cols} (and for \code{type="reps"} may also be \code{"Replicate"}).
Defaults to the first element of \code{result$grp_cols}.}

\item{color_by}{Character. Fill aesthetic: \code{"Protein.group"}, \code{"Protein.name"}, or \code{"none"}.
Default: \code{"Protein.group"}.}

\item{filter_params}{Named list, or \code{NULL}.  Each element’s name is a grouping column,
and its value is a vector of values to include.  Multiple names impose an AND filter.
For example: \code{list(Lipid = c("N","S"), Digest.stage = "G")}
Default: \code{NULL} (no filtering).}

\item{facet_rows}{Character(1) or \code{NULL}.  Name of grouping column(s) for row facets.
You can combine multiple variables with a plus: e.g.
\code{"Casein.ratio+Digest.stage"}.  Default: \code{NULL}.}

\item{facet_cols}{Character(1) or \code{NULL}.  Name of grouping column(s) for column facets.
Defaults to \code{"Replicate"} if \code{type = "reps"} and not explicitly set.
You can combine multiple variables with a plus, e.g.
\code{"Lipid+Replicate"}.  Default: \code{NULL}.}

\item{scientific_10_y}{Logical.  If \code{TRUE}, use scientific notation for y-axis.
Default: \code{TRUE}.}
}
\value{
A \code{ggplot} object.
}
\description{
Generates stacked‐bar charts of peptide intensities (per‐replicate or group‐mean)
with:
\itemize{
\item User‐defined inclusion filters on any grouping columns,
\item Dynamic x‐axis chosen from grouping variables,
\item Flexible coloring by protein group or protein name,
\item Optional scientific notationn of the y‐axis,
\item Flexible faceting by one or more grouping variables.
}
}
\examples{
\dontrun{
result <- processPeptides(
  peptides_file          = "../Data/peptides.txt",
  intensity_columns_file = "../Data/Intensity_columns.csv",
  protein_mapping_file   = "../Data/protein_mapping.csv"
)

# 1) Simple replicate‐level, default x, default facet="Replicate"
p1 <- plot_int(result, type = "reps")

# 2) Simple mean‐level, x = Lipid, color by Protein.name, y axis not scientific notation
p2 <- plot_int(result,
               type             = "mean",
               x_var            = "Lipid",
               color_by         = "Protein.name",
               scientific_10_y  = FALSE)

# 3) Complex filter: Lipid in N or S AND Digest.stage == "G"
p3 <- plot_int(result,
               type          = "reps",
               filter_params = list(Lipid = c("N","S"),
                                    Digest.stage = "G"))

# 4) Complex filter to exclude a level (NOT): all Lipids except "N"
p4 <- plot_int(result,
               type          = "reps",
               filter_params = list(
               Lipid         = setdiff(unique(result$dt.peptides.int.reps$Lipid), "N")
               ))

# 5) Multi‐variable faceting: rows = Casein.ratio+Digest.stage, cols = Lipid+Replicate
p5 <- plot_int(result,
               type        = "reps",
               facet_rows  = "Casein.ratio+Digest.stage",
               facet_cols  = "Lipid+Replicate")
}

}
