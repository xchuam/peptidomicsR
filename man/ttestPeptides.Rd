% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ttestPeptides.R
\name{ttestPeptides}
\alias{ttestPeptides}
\title{Compare peptide intensities between user-defined groups (t-test)}
\usage{
ttestPeptides(
  result,
  comparisons,
  pseudocount = 1,
  equal_var = FALSE,
  alternative = c("two.sided", "less", "greater"),
  adjust = "BH",
  min_reps_per_side = 2
)
}
\arguments{
\item{comparisons}{Either:
\itemize{
\item a list of character pairs, e.g. \code{list(list(c("C40_G_N", "C40_G_S")), list(c("C40_G", "C40_G")))},
or
\item a single character vector of length 2, e.g. \code{c("C40_G_N", "C40_G_S")}.
Each selector is a character string describing one set of samples, using the levels from
\code{result$grp_cols} joined by underscores. Order of tokens is flexible.
Examples:
\item \code{"C40_G_N"} vs \code{"C40_G_S"}: full specification (Casein.ratio = C40,
Digest.stage = G, Lipid = N vs S).
\item \code{"C40_N_G"} vs \code{"C40_S_G"}: same as above, token order does not matter.
\item \code{"C40_N"} vs \code{"C40_S"}: partial specification. Here, samples are pooled
across unspecified grouping columns (warning issued).
Disambiguation: If a token could belong to more than one grouping column,
use the \code{col=value} form. For example, \code{"Digest.stage=G_Lipid=G"} explicitly
selects \code{Digest.stage = G} and \code{Lipid = G}.
}}

\item{pseudocount}{Numeric. Value used to replace zero intensities before
statistical testing. This helps avoid issues with log2 transformation and division by zero.
Default: 1.}

\item{equal_var}{Logical. If \code{TRUE}, use Student's t-test with equal
variances; otherwise Welch's test (default).}

\item{alternative}{Character. \code{"two.sided"} (default), \code{"less"}, or \code{"greater"}.}

\item{adjust}{Character. Method passed to \code{\link[stats:p.adjust]{stats::p.adjust()}}, default \code{"BH"}.}

\item{min_reps_per_side}{Integer. Minimum non-NA observations required on
each side to perform a test. Default: 2.}
}
\value{
A named list of \code{data.table}, one per comparison. Each table has one
row per peptide and includes:
\code{t}, \code{df}, \code{p.value}, \code{log2FC}, \code{p.adj}.
}
\description{
Performs two-sample t-tests on peptide replicate intensities between
user-specified groups. Groups are defined by levels in the columns listed
in \code{result$grp_cols}, and replicate values are taken from columns \code{R1..Rn}
in \code{result$dt.peptides.int.ttest}. Users can specify selectors as
underscore-joined tokens (e.g., \code{"C1_B1_T1"}), in any order (e.g.,
\code{"B1_T1_C1"}), and may omit some grouping columns (e.g., \code{"C1_B1"}). If a
selector omits some grouping columns, replicates across the omitted
dimensions are pooled (a warning is issued).

Zero intensities are replaced by a pseudocount provided by the user with default value 1.

#' @param result List. Output of \code{processPeptides()}. Must contain:
\itemize{
\item \code{dt.peptides.int.ttest}: data.table with peptide intensities for t.test analysis.
\item \code{grp_cols}: character vector of grouping columns to define sample groups.
}
}
\examples{
\dontrun{
# Prepare data
result <- processPeptides(
  peptides_file          = "../Data/peptides.txt",
  intensity_columns_file = "../Data/Intensity_columns.csv",
  protein_mapping_file   = "../Data/protein_mapping.csv"
)


#  1) One t.test with specification of groups
ttest.1 <- ttestPeptides(
  result,
  comparisons = list(c("C40_G_N", "C40_I_N"))
)

#  2) For one t.test, the comparisons can be a a single character vector
ttest.2 <- ttestPeptides(
  result,
  comparisons = c("C40_G_N", "C40_I_N")
)

#  3) Token order does not matter
# Same comparison, different token order
ttest.3 <- ttestPeptides(
  result,
  comparisons = list(c("G_N_C40", "I_N_C40"))
)

#  4) More than one t.test can be done at one time
ttest.4 <- ttestPeptides(
  result,
  comparisons = list(
    c("C40_G_N", "C40_I_N"),
    c("C40_G_N", "C80_I_N")
  )
)

#  5) Partial specification (pools over omitted column)
ttest.5 <- ttestPeptides(
  result,
  comparisons = list(c("C40_G", "C80_G"))
)

#  6) Explicit disambiguation using col=value syntax
# Equivalent to Example 1 but written with explicit column names
ttest.6 <- ttestPeptides(
  result,
  comparisons = list(c("Casein.ratio=C40_Digest.stage=G_Lipid=N",
                       "Casein.ratio=C40_Digest.stage=I_Lipid=N"))
)


# Access the first comparison result table
ttest.1[[1]][order(p.adj)][1:10]
}

}
